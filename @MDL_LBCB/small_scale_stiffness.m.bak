% stiffness matrix of beam-column joint. Full scale
% beam x, y, rz, column_bot, x, y, rz,  column top, x, y, ra

K = [
  9.6805020e+002  1.3004604e+001  6.0787584e+002 -4.0464870e+002 -5.6658240e+000  2.0595864e+004 -5.6340150e+002 -7.3387800e+000 -2.4790064e+004
  1.3022808e+001  7.5363240e+001  5.3027496e+003  3.2058900e+001 -3.2912694e+001 -1.2929605e+003 -4.5081708e+001 -4.2450546e+001 -1.3313945e+003
  6.2601156e+002  5.3030808e+003  4.9690109e+005  1.5404861e+003 -2.3160172e+003 -6.2165513e+004 -2.1664976e+003 -2.9870636e+003 -6.3884614e+004
 -4.0465680e+002  3.2062560e+001  1.5482131e+003  2.5955280e+002 -1.4011044e+001 -1.6649957e+004  1.4510400e+002 -1.8051516e+001  2.4732936e+003
 -5.8420680e+000 -3.2914812e+001 -2.3165662e+003 -1.3704258e+001  7.1278483e+003  1.3975713e+003  1.9546326e+001 -7.0949335e+003  4.6802736e+002
  2.0510364e+004 -1.2957305e+003 -6.2636492e+004 -1.6615410e+004  5.6667967e+002  1.5158332e+006 -3.8949531e+003  7.2905083e+002 -1.8372619e+004
 -5.6339340e+002 -4.5067164e+001 -2.1560890e+003  1.4509590e+002  1.9676868e+001 -3.9459066e+003  4.1829750e+002  2.5390296e+001  2.2316771e+004
 -7.1807400e+000 -4.2448428e+001 -2.9861834e+003 -1.8354642e+001 -7.0949356e+003 -1.0461087e+002  2.5535382e+001  7.1373840e+003  8.6336712e+002
 -2.4788041e+004 -1.3289987e+003 -6.3438768e+004  2.4742764e+003  5.8021416e+002 -2.0666124e+004  2.2313765e+004  7.4878452e+002  1.7361512e+006];
 
 

K_rel = K([1:3 7:9], [1:3 7:9]);

% length scale factor
ScaleF = 1/6;

% force scale factor
F_sf = ScaleF^2;

% moment scale factor 
M_sf = ScaleF^3;

% scale factor for force vector: f = SF*F where f is force of small scale specimen, F is force of full scale
SF_F = diag([F_sf F_sf M_sf F_sf F_sf M_sf]);

% scale factor for displacement vector: d = SF*D
SF_D = diag([ScaleF ScaleF 1 ScaleF ScaleF 1 ]);

% stiffness matrix of small scale specimen. relative (column bottom fixed). Beam x, y, rz, column top x, y, rz. 
% unit of lb and inch.
k_rel = SF_F * K_rel * inv(SF_D) *1000
